<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>현재 접속 중인 사용자</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        #navbar {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding: 10px;
            background: #f4f4f4;
            position: fixed;
            top: 0;
            right: 0;
            width: 60%;
        }
    </style>
</head>
<body>
    <!-- 🔥 네비게이션 바 추가 -->
    <div id="navbar">
        <button onclick="window.location.href='/chat.html'">Chat</button>
        <button onclick="window.location.href='/'">Logout</button>
    </div>

    <h2>현재 접속 중인 사용자</h2>
    <div id="user-list">로딩 중...</div>

    <script>
        const socket = io();

        socket.on("update users", (users) => {
            displayUsers(users);
        });

        function displayUsers(users) {
            const userList = document.getElementById("user-list");
            userList.innerHTML = "";

            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];

            users.forEach(user => {
                const userItem = document.createElement("div");
                userItem.innerHTML = `
                    <span>${user} (${formattedDate})</span>
                    <button onclick="startDM('${user}')">DM</button>
                `;
                userList.appendChild(userItem);
            });
        }

        function startDM(user) {
            window.location.href = `/dm.html?to=${user}`;
        }
    </script>
</body>
</html>
